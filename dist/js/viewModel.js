function Errors(){var e=this;e.fourSquareErrorCalled=!1,e.googleErrorCalled=!1,e.fourSquareError=function(o){e.fourSquareErrorCalled===!1&&(e.errorPrompt(o),e.fourSquareErrorCalled=!0)},e.googleError=function(o){e.googleErrorCalled===!1&&(e.errorPrompt(o),e.googleErrorCalled=!0)},e.errorPrompt=function(e){}}function Location(e,o){var r=this;r.name=e,r.address=o,r.marker=null,r.thirdPartyPhotos=null,r.thirdPartyData=null}function LocationViewModel(){var e=this,o=null;e.filterInput=ko.observable(""),e.locationList=ko.observableArray([new Location("Google","1600 Amphitheatre Pkwy, Mountain View, CA 94043"),new Location("Shoreline Amphitheatre","1 Amphitheatre Pkwy, Mountain View, CA 94043"),new Location("Mozart Foundation Automobile Museum","1325 Pear Ave, Mountain View, CA 94043"),new Location("Computer History Museum","1401 N Shoreline Blvd, Mountain View, CA 94043"),new Location("Century Cinema 16","1500 N Shoreline Blvd, Mountain View, CA 94043")]),e.removeFilter=function(){for(var o=0;o<e.locationList().length;o++)null!==e.locationList()[o].marker&&e.locationList()[o].marker.setVisible(!0);e.filterInput(""),infoWindow.close()},e.filteredLocations=ko.computed(function(){if(e.filterInput()){for(var o=ko.utils.arrayFilter(e.locationList(),function(o){return o.name.toLowerCase().indexOf(e.filterInput().toLowerCase())!==-1}),r=0;r<e.locationList().length;r++)e.locationList()[r].marker.setVisible(!1);for(var t=0;t<o.length;t++)o[t].marker.setVisible(!0);return o}return e.removeFilter(),e.locationList()}),e.getMarker=function(o,t,a){$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?address="+t.replace(/ /g,"+")+MAP_KEY,function(t){var n=findItemInArray(e.locationList,o);if(e.locationList()[n].marker=new google.maps.Marker({position:{lat:t.results[0].geometry.location.lat,lng:t.results[0].geometry.location.lng},map:map,title:o}),e.attachInfoWindow(e.locationList()[n].marker),e.locationList()[n].thirdPartyPhotos=imageHTML.replace("%%data","https://maps.googleapis.com/maps/api/streetview?size=300x150&location="+t.results[0].geometry.location.lat+","+t.results[0].geometry.location.lng+"&heading=200&pitch=-0.76&key="+MAP_KEY),r++,r===a){for(var i=new Array(5),l=0;l<e.locationList().length;l++)i[l]=e.locationList()[l].marker;resizeMap(i)}}).fail(function(e,o,r){errorNotification.googleError("Failed to load data from Google please refresh")})},e.getThirdPartyData=function(o,r){$.ajax({method:"GET",url:"https://api.foursquare.com/v2/venues/search?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRECT+"&v=20130815 &near=Mountain+View&query="+o.replace(/ /g,"+")+"&address"+r.replace(/ /g,"+")}).done(function(r){var t,a=findItemInArray(e.locationList,o);t=void 0!==r.response.venues[0].name?headerHTML.replace("%%data",r.response.venues[0].name):headerHTML.replace("%%data","Name Could Not Loaded"),t+=void 0!==r.response.venues[0].hereNow.count?infoHTML.replace("%%data","People here now").replace("%%data",r.response.venues[0].hereNow.count):infoHTML.replace("%%data","Could not load number of people here"),t+=void 0!==r.response.venues[0].stats.checkinsCount?infoHTML.replace("%%data","Check in count").replace("%%data",r.response.venues[0].stats.checkinsCount):infoHTML.replace("%%data","Could not load number of checkins"),t+=hyperLinkHTML.replace("%%data","https://foursquare.com/").replace("%%data","Provided by Foursquare"),e.locationList()[a].thirdPartyData=t}).fail(function(e,o,r){errorNotification.fourSquareError("Failed to load data from FourSquare please refresh")})},e.attachInfoWindow=function(o){o.addListener("click",function(){for(var r=0;r<e.locationList().length;r++)if(o===e.locationList()[r].marker){e.displayInfoWindow(e.locationList()[r]);break}})},e.selectMarker=function(o){e.displayInfoWindow(o)},e.displayInfoWindow=function(r){o===r.marker?e.resetMarkers():(o=r.marker,e.resetOtherMarkers(),infoWindow.setContent(r.thirdPartyPhotos+r.thirdPartyData),infoWindow.open(map,r.marker),map.setCenter(o.getPosition()),r.marker.setAnimation(google.maps.Animation.BOUNCE))},e.resetMarkers=function(){for(var r=0;r<e.locationList().length;r++)e.locationList()[r].marker.setAnimation(null);infoWindow.close(),o=null},e.resetOtherMarkers=function(){for(var o=0;o<e.locationList().length;o++)e.locationList()[o].marker.setAnimation(null)};for(var r=0,t=e.locationList().length,a=0;a<e.locationList().length;a++)e.getMarker(e.locationList()[a].name,e.locationList()[a].address,t),e.getThirdPartyData(e.locationList()[a].name,e.locationList()[a].address)}function findItemInArray(e,o){for(var r=0;r<e().length;r++)if(e()[r].name===o)return r;return-1}var MAP_KEY="AIzaSyCkW6FCwPhwzhiHG48DbjzCFP_1lGXLQWA",CLIENT_ID="ZWI00VLLOOCDO3KNPL1URSOBTSK3BNUVJYTI3PDMDQES4E2S",CLIENT_SECRECT="QLCIS5IGUN1QWOW5GLCKBTAKIISEFE3QHTS011R1C0DLI1DP",headerHTML='<h1 class="info-header">%%data</h1>',infoHTML='<p class="info-p">%%data %%data</p>',hyperLinkHTML='<a href="%%data" class="info-hyperlink">%%data</a>',imageHTML='<img src="%%data">',errorNotification=new Errors;